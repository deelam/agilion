<html ng-app="helloApp">
<head>
    <title>Hello ReactJS - Add or Remove A Table Row - Code Example</title>
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
    <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.2.20/angular.min.js"></script>
    <script src="assets/js/ui-bootstrap-tpls-0.9.0.min.js"></script>
    <script src="http://fb.me/react-0.11.1.js"></script>
    <script src="http://fb.me/JSXTransformer-0.11.1.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create', 'UA-37706354-1', 'tuts-javascript.appspot.com');ga('send', 'pageview');</script>
    <script>
	var helloApp = angular.module("helloApp", [ 'ui.bootstrap' ]);
	</script>
</head>
<body>
<header class="navbar navbar-static-top" id="top" role="banner">
    <div class="container">
        <header class="navbar navbar-default navbar-fixed-top">
            <div class="navbar-inner">
                <div class="container">
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle" data-toggle="collapse"
                                data-target="#bs-example-navbar-collapse-3"
                                ng-click="isCollapsed = !isCollapsed">
                            <span class="sr-only">Toggle navigation</span> <span
                                class="icon-bar"></span> <span class="icon-bar"></span> <span
                                class="icon-bar"></span>
                        </button>
                        <a class="navbar-brand visible-xs" href="#">UI Bootstrap</a>
                    </div>
                    <nav class="hidden-xs">
                        <ul class="nav navbar-nav">
                            <a href="/" role="button" class="navbar-brand"> Home </a>
                            <li class="dropdown"><a role="button" class="dropdown-toggle">
                                ReactJS<b class="caret"></b>
                            </a>
                                <ul class="dropdown-menu" role="menu">
                                    <li><a href="/hello-world-reactjs">Hello World</a></li>
                                    <li><a href="/reactjs-add-table-row">Add Table Row
                                        Dynamically</a></li>
                                    <li><a href="/reactjs-add-remove-table-row">Add/Remove
                                        Table Row Dynamically</a></li>
                                </ul></li>
                            <li class="dropdown"><a role="button" class="dropdown-toggle">
                                AngularJS<b class="caret"></b>
                            </a>
                                <ul class="dropdown-menu">
                                    <li><a href="http://hello-angularjs.appspot.com/helloworld" target="_blank" rel="nofollow">Hello World</a></li>
                                    <li><a href="http://hello-angularjs.appspot.com/addtablerow" target="_blank" rel="nofollow">Add Table Row Dynamically</a></li>
                                    <li><a href="http://hello-angularjs.appspot.com/removetablerow" target="_blank" rel="nofollow">Remove Table Row
                                        Dynamically</a></li>
                                    <li><a href="http://hello-angularjs.appspot.com/searchtable" target="_blank" rel="nofollow">Search Table</a></li>
                                    <li><a href="http://hello-angularjs.appspot.com/sorttablecolumn" target="_blank" rel="nofollow">Sorting Table Columns</a></li>
                                    <li><a href="http://hello-angularjs.appspot.com/spa" target="_blank" rel="nofollow">Routing & Single Page Application
                                        (SPA)</a></li>
                                    <li><a href="http://hello-angularjs.appspot.com/angularjs-unit-test-code-example-1" target="_blank" rel="nofollow">Unit
                                        Test Code Example 1</a></li>
                                    <li><a href="http://hello-angularjs.appspot.com/angularjs-filters-examples" target="_blank" rel="nofollow">Filters
                                        Examples</a></li>
                                    <li><a href="http://hello-angularjs.appspot.com/angularjs-http-service-ajax-get-code-example" target="_blank" rel="nofollow">AJAX
                                        GET &amp; Spring MVC Example</a></li>
                                    <li><a
                                            href="http://hello-angularjs.appspot.com/angularjs-http-service-ajax-post-code-example" target="_blank" rel="nofollow">AJAX
                                        POST &amp; Spring MVC Example</a></li>
                                    <li><a
                                            href="http://hello-angularjs.appspot.com/angularjs-http-service-ajax-post-json-data-code-example" target="_blank" rel="nofollow">AJAX
                                        POST JSON Data &amp; Spring MVC Example</a></li>
                                    <li><a
                                            href="http://hello-angularjs.appspot.com/angularjs-restful-apis-get-method-code-example" target="_blank" rel="nofollow">Consuming
                                        RESTful APIs with ngResource and Spring MVC</a></li>
                                    <li><a
                                            href="http://hello-angularjs.appspot.com/angularjs-restful-apis-post-method-code-example" target="_blank" rel="nofollow">Post
                                        with RESTful APIs, ngResource and Spring MVC</a></li>
                                    <li><a href="http://hello-angularjs.appspot.com/angularjs-single-page-app-restful-apis" target="_blank" rel="nofollow">Single
                                        Page App with RESTful APIs</a></li>
                                    <li><a href="http://hello-angularjs.appspot.com/angularjs-create-custom-services" target="_blank" rel="nofollow">How to
                                        Create Custom Service</a></li>
                                    <li><a href="http://hello-angularjs.appspot.com/angularjs-how-create-custom-directives" target="_blank" rel="nofollow">How
                                        to Create Custom Directives</a></li>
                                </ul></li>

                            <li class="dropdown"><a role="button" class="dropdown-toggle">
                                KnockoutJS<b class="caret"></b>
                            </a>
                                <ul class="dropdown-menu" role="menu">
                                    <li><a href="/helloworld-knockoutjs">Hello World</a></li>
                                </ul></li>
                        </ul>
                    </nav>
                </div>
            </div>
        </header>
        <div class="header-placeholder"></div>
    </div></header>
<div class="container">
    <div class="page-header">
        <h1>ReactJS - Add/Remove a Table Row - Code Example</h1>
    </div>
    <div>
        The demo represents the high level concepts around adding or removing a table row dynamically using ReactJS, a Javascript library for building UI.
    </div>
    <div id="companyApp"></div>
    <div class="panel panel-primary">
        <div class="panel-heading">
            <h3 class="panel-title">Notes</h3>
        </div>
        <div class="panel-body">
            <!-- Notes goes here -->
            <ul>
                <li>Following is demonstrated as part of this demo:
                    <ol>
                        <li>Composite Components</li>
                        <li>Event Delegation</li>
                    </ol>
                </li>
                <li>The design of UI components is laid out in following manner:
                    <ul>
                        <li>CompanyApp Component
                            <ul>
                                <li>CompanyList: Encapsulates the render code for displaying list of companies</li>
                                <li>Company: Object representing Company. Demonstrates on how to bind onClick event for deleting and passing the event right to the parent to mutate the state.</li>
                                <li>NewRow: Object used to capture the input data. Represents the state.</li>
                            </ul>
                        </li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>
</div>
<script type="text/jsx">
      /** @jsx React.DOM */
      var CompanyApp = React.createClass({
        getInitialState: function() {
          return {companylist:this.props.companies};
        },
        handleNewRowSubmit: function( newcompany ) {
          this.setState( {companylist: this.state.companylist.concat([newcompany])} );
        },
        handleCompanyRemove: function( company ) {

          var index = -1;
          var clength = this.state.companylist.length;
      		for( var i = 0; i < clength; i++ ) {
      			if( this.state.companylist[i].cname === company.cname ) {
      				index = i;
      				break;
      			}
      		}
      		this.state.companylist.splice( index, 1 );
      		this.setState( {companylist: this.state.companylist} );
        },
        render: function() {
          var tableStyle = {width: '100%'};
          var leftTdStyle = {width: '50%',padding:'20px',verticalAlign: 'top'};
          var rightTdStyle = {width: '50%',padding:'20px',verticalAlign: 'top'};
          return (
            <table style={tableStyle}>
              <tr>
                <td style={leftTdStyle}>
                  <CompanyList clist={this.state.companylist}  onCompanyRemove={this.handleCompanyRemove}/>
                </td>
                <td style={rightTdStyle}>
                  <NewRow onRowSubmit={this.handleNewRowSubmit}/>
                </td>
              </tr>
          </table>
          );
        }
      });

      var CompanyList = React.createClass({
        handleCompanyRemove: function(company){
          this.props.onCompanyRemove( company );
        },
        render: function() {
          var companies = [];
          var that = this; // TODO: Needs to find out why that = this made it work; Was getting error that onCompanyDelete is not undefined
          this.props.clist.forEach(function(company) {
            companies.push(<Company company={company} onCompanyDelete={that.handleCompanyRemove} /> );
          });
          return (
            <div>
              <h3>List of Companies</h3>
              <table className="table table-striped">
                <thead><tr><th>Company Name</th><th>Employees</th><th>Head Office</th><th>Action</th></tr></thead>
                <tbody>{companies}</tbody>
              </table>
            </div>
            );
        }
      });

      var Company = React.createClass({
        handleRemoveCompany: function() {
          this.props.onCompanyDelete( this.props.company );
          return false;
        },
        render: function() {
          return (
            <tr>
              <td>{this.props.company.cname}</td>
              <td>{this.props.company.ecount}</td>
              <td>{this.props.company.hoffice}</td>
              <td><input type="button"  className="btn btn-primary" value="Remove" onClick={this.handleRemoveCompany}/></td>
            </tr>
            );
        }
      });

      var NewRow = React.createClass({
        handleSubmit: function() {
          var cname = this.refs.cname.getDOMNode().value;
          var ecount = this.refs.ecount.getDOMNode().value;
          var hoffice = this.refs.hoffice.getDOMNode().value;
          var newrow = {cname: cname, ecount: ecount, hoffice: hoffice };
          this.props.onRowSubmit( newrow );

          this.refs.cname.getDOMNode().value = '';
          this.refs.ecount.getDOMNode().value = '';
          this.refs.hoffice.getDOMNode().value = '';
          return false;
        },
        render: function() {
          var inputStyle = {padding:'12px'}
          return (
            <div className="well">
              <h3>Add A Company</h3>
            <form onSubmit={this.handleSubmit}>
              <div className="input-group input-group-lg" style={inputStyle}>
                <input type="text"  className="form-control col-md-8"  placeholder="Company Name" ref="cname"/>
              </div>
              <div className="input-group input-group-lg" style={inputStyle}>
                <input type="text"  className="form-control col-md-8" placeholder="Employee Count" ref="ecount"/>
              </div>
              <div className="input-group input-group-lg" style={inputStyle}>
                <input type="text"  className="form-control col-md-8" placeholder="Headoffice" ref="hoffice"/>
              </div>
              <div className="input-group input-group-lg" style={inputStyle}>
                <input type="submit"  className="btn btn-primary" value="Add Company"/>
              </div>
            </form>
            </div>
            );
        }
      });
      var defCompanies = [{cname:"Infosys Technologies",ecount:150000,hoffice:"Bangalore"},{cname:"TCS",ecount:140000,hoffice:"Mumbai"}];
      React.renderComponent( <CompanyApp companies={defCompanies}/>, document.getElementById( "companyApp" ) );
    </script>
</body>
</html>